import React, { useState, useEffect, useCallback, useMemo, useRef } from 'react';
import { motion, AnimatePresence } from 'framer-motion';

// =================================================================================================
// SISTEMA DE GESTI√ìN DE APUNTES PARA GITHUB - VERSI√ìN SIMPLIFICADA
// =================================================================================================
// Este componente implementa una interfaz elegante y futurista para visualizar apuntes acad√©micos
// directamente desde un repositorio de GitHub. Caracter√≠sticas principales:
// - Navegaci√≥n jer√°rquica por cursos, asignaturas y temas
// - Visualizaci√≥n de archivos de c√≥digo (.java, .sql, etc.) directamente desde el repositorio
// - Resaltado de sintaxis para m√∫ltiples lenguajes de programaci√≥n
// - Dise√±o responsive con est√©tica de libro digital y elementos futuristas
// - Optimizado para funcionar en GitHub Pages sin backend
// - Sin ejecuci√≥n de c√≥digo, solo visualizaci√≥n de contenido
// =================================================================================================

const App = () => {
  // =================================================================================================
  // CONFIGURACI√ìN DE RUTAS PARA ARCHIVOS EN EL REPOSITORIO
  // =================================================================================================
  // Estructura de carpetas esperada en el repositorio:
  // raiz-del-repo/
  //   ‚îú‚îÄ‚îÄ notes/
  //   ‚îÇ   ‚îú‚îÄ‚îÄ DAM/
  //   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Programacion/
  //   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Java_Basico/
  //   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ HolaMundo.java
  //   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Variables.java
  //   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ POO/
  //   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Coche.java
  //   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Herencia.java
  //   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Base_de_Datos/
  //   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SQL_Basico/
  //   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ConsultaBasica.sql
  //   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ JoinEjemplo.sql
  //   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Sistemas_Informaticos/
  //   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Entornos_de_Desarrollo/
  //   ‚îÇ   ‚îî‚îÄ‚îÄ DAW/
  //   ‚îî‚îÄ‚îÄ index.html (este archivo)
  
  // Base path para los archivos de notas (ajustar seg√∫n la estructura del repositorio)
  const BASE_NOTES_PATH = 'notes';
  
  // =================================================================================================
  // ESTADO DE LA APLICACI√ìN - GESTI√ìN DE DATOS Y NAVEGACI√ìN
  // =================================================================================================
  
  // Estado para el curso actual seleccionado (por defecto DAM)
  const [currentCourse, setCurrentCourse] = useState('DAM');
  
  // Estado para la asignatura actual seleccionada
  const [currentSubject, setCurrentSubject] = useState('Programacion');
  
  // Estado para el tema actual seleccionado dentro de una asignatura
  const [currentTopic, setCurrentTopic] = useState('Java_Basico');
  
  // Estado para los archivos disponibles en el tema actual
  const [topicFiles, setTopicFiles] = useState([]);
  
  // Estado para el archivo actualmente seleccionado para previsualizaci√≥n
  const [selectedFile, setSelectedFile] = useState(null);
  
  // Estado para el contenido del archivo seleccionado
  const [fileContent, setFileContent] = useState('');
  
  // Estado para el modo oscuro/claro (por defecto oscuro para est√©tica futurista)
  const [darkMode, setDarkMode] = useState(true);
  
  // Estado para la animaci√≥n de carga al procesar archivos
  const [isLoading, setIsLoading] = useState(false);
  
  // Estado para el historial de navegaci√≥n (simulando breadcrumbs)
  const [navigationHistory, setNavigationHistory] = useState(['DAM', 'Programacion', 'Java_Basico']);
  
  // Estado para el tema de color de la interfaz
  const [accentColor, setAccentColor] = useState('#6366f1'); // Color por defecto: √≠ndigo
  
  // Estado para el error al cargar archivos
  const [loadError, setLoadError] = useState(null);
  
  // Referencia para el √°rea de c√≥digo
  const codeAreaRef = useRef(null);
  
  // =================================================================================================
  // CONFIGURACI√ìN DE ESTRUCTURA DE CURSOS Y ASIGNATURAS
  // =================================================================================================
  
  // Mapeo de nombres amigables para mostrar en la interfaz
  const courseDisplayNames = useMemo(() => ({
    'DAM': 'DAM (Desarrollo de Aplicaciones Multiplataforma)',
    'DAW': 'DAW (Desarrollo de Aplicaciones Web)'
  }), []);
  
  const subjectDisplayNames = useMemo(() => ({
    'Programacion': 'Programaci√≥n',
    'Base_de_Datos': 'Base de Datos',
    'Sistemas_Informaticos': 'Sistemas Inform√°ticos',
    'Entornos_de_Desarrollo': 'Entornos de Desarrollo'
  }), []);
  
  const topicDisplayNames = useMemo(() => ({
    'Java_Basico': 'Java B√°sico',
    'POO': 'Programaci√≥n Orientada a Objetos',
    'Estructuras_de_Datos': 'Estructuras de Datos',
    'Excepciones': 'Manejo de Excepciones',
    'Colecciones': 'Colecciones Java',
    'SQL_Basico': 'SQL B√°sico',
    'Consultas_Avanzadas': 'Consultas Avanzadas',
    'Procedimientos': 'Procedimientos Almacenados',
    'Triggers': 'Triggers y Eventos',
    'Modelado': 'Modelado de Datos',
    'Arquitectura': 'Arquitectura de Computadores',
    'Redes': 'Fundamentos de Redes',
    'Sistemas_Operativos': 'Sistemas Operativos',
    'Virtualizacion': 'Virtualizaci√≥n',
    'Git': 'Control de Versiones con Git',
    'Maven': 'Gesti√≥n de Proyectos con Maven',
    'Docker': 'Contenerizaci√≥n con Docker',
    'Metodologias_Agiles': 'Metodolog√≠as √Ågiles'
  }), []);
  
  // Estructura est√°tica de temas por asignatura (sin gesti√≥n din√°mica)
  const topicsStructure = useMemo(() => ({
    'Programacion': ['Java_Basico', 'POO', 'Estructuras_de_Datos', 'Excepciones', 'Colecciones'],
    'Base_de_Datos': ['SQL_Basico', 'Consultas_Avanzadas', 'Procedimientos', 'Triggers', 'Modelado'],
    'Sistemas_Informaticos': ['Arquitectura', 'Redes', 'Sistemas_Operativos', 'Virtualizacion'],
    'Entornos_de_Desarrollo': ['Git', 'Maven', 'Docker', 'Metodologias_Agiles']
  }), []);
  
  // =================================================================================================
  // FUNCIONES DE CARGA DE ARCHIVOS DESDE EL REPOSITORIO
  // =================================================================================================
  
  // Funci√≥n para cargar la lista de archivos de un tema espec√≠fico
  const loadTopicFiles = useCallback(async (course, subject, topic) => {
    setIsLoading(true);
    setLoadError(null);
    
    try {
      // Simular la carga de archivos (en producci√≥n, esto se reemplazar√≠a con una llamada a un √≠ndice JSON)
      const simulatedFiles = getSimulatedFiles(course, subject, topic);
      setTopicFiles(simulatedFiles);
      
      // Si hay archivos, seleccionar el primero autom√°ticamente
      if (simulatedFiles.length > 0 && !selectedFile) {
        await loadFileContent(course, subject, topic, simulatedFiles[0].name);
      }
    } catch (error) {
      console.error('Error al cargar archivos del tema:', error);
      setLoadError('No se pudieron cargar los archivos. Verifica la estructura de carpetas en el repositorio.');
      setTopicFiles([]);
    } finally {
      setIsLoading(false);
    }
  }, [selectedFile]);
  
  // Funci√≥n para cargar el contenido de un archivo espec√≠fico
  const loadFileContent = useCallback(async (course, subject, topic, fileName) => {
    setIsLoading(true);
    setLoadError(null);
    
    try {
      // Obtener contenido simulado (en producci√≥n, reemplazar con fetch al archivo real)
      const content = getSimulatedFileContent(fileName);
      
      // Actualizar el estado con el contenido del archivo
      setSelectedFile(fileName);
      setFileContent(content);
      
      // Actualizar historial de navegaci√≥n
      setNavigationHistory([course, subject, topic, fileName]);
    } catch (error) {
      console.error('Error al cargar el archivo:', error);
      setLoadError(`Error al cargar el archivo: ${error.message}`);
      setFileContent(`// Error: No se pudo cargar el contenido del archivo ${fileName}`);
    } finally {
      setIsLoading(false);
    }
  }, []);
  
  // =================================================================================================
  // DATOS DE SIMULACI√ìN - ESTRUCTURA DE ARCHIVOS Y CONTENIDOS
  // =================================================================================================
  // NOTA: En una implementaci√≥n real para GitHub, estos datos se cargar√≠an desde archivos reales
  // en el repositorio. Esta simulaci√≥n permite que la aplicaci√≥n funcione sin conexi√≥n y muestre
  // ejemplos significativos mientras se configura la estructura real del repositorio.
  
  // Funci√≥n para obtener archivos simulados seg√∫n la ruta
  const getSimulatedFiles = useCallback((course, subject, topic) => {
    // Definir la estructura simulada de archivos
    const simulatedStructure = {
      'DAM': {
        'Programacion': {
          'Java_Basico': [
            { name: 'HolaMundo.java', type: 'java', size: '0.3 KB', lastModified: '2026-01-15' },
            { name: 'Variables.java', type: 'java', size: '0.5 KB', lastModified: '2026-01-16' },
            { name: 'Condicionales.java', type: 'java', size: '0.7 KB', lastModified: '2026-01-17' },
            { name: 'Bucles.java', type: 'java', size: '0.8 KB', lastModified: '2026-01-18' }
          ],
          'POO': [
            { name: 'ClaseCoche.java', type: 'java', size: '1.2 KB', lastModified: '2026-01-20' },
            { name: 'Herencia.java', type: 'java', size: '1.5 KB', lastModified: '2026-01-21' },
            { name: 'Interfaces.java', type: 'java', size: '1.3 KB', lastModified: '2026-01-22' },
            { name: 'Polimorfismo.java', type: 'java', size: '1.7 KB', lastModified: '2026-01-23' }
          ],
          'Estructuras_de_Datos': [
            { name: 'Arrays.java', type: 'java', size: '0.9 KB', lastModified: '2026-01-25' },
            { name: 'ArrayList.java', type: 'java', size: '1.1 KB', lastModified: '2026-01-26' },
            { name: 'HashMap.java', type: 'java', size: '1.4 KB', lastModified: '2026-01-27' }
          ]
        },
        'Base_de_Datos': {
          'SQL_Basico': [
            { name: 'CrearTablas.sql', type: 'sql', size: '0.4 KB', lastModified: '2026-01-30' },
            { name: 'InsertarDatos.sql', type: 'sql', size: '0.6 KB', lastModified: '2026-01-31' },
            { name: 'ConsultasBasicas.sql', type: 'sql', size: '0.8 KB', lastModified: '2026-02-01' }
          ],
          'Consultas_Avanzadas': [
            { name: 'Joins.sql', type: 'sql', size: '1.0 KB', lastModified: '2026-02-03' },
            { name: 'Subconsultas.sql', type: 'sql', size: '1.2 KB', lastModified: '2026-02-04' },
            { name: 'FuncionesAgregacion.sql', type: 'sql', size: '0.9 KB', lastModified: '2026-02-05' }
          ]
        },
        'Sistemas_Informaticos': {
          'Arquitectura': [
            { name: 'ComponentesPC.txt', type: 'txt', size: '1.5 KB', lastModified: '2026-02-10' },
            { name: 'MemoriaCache.txt', type: 'txt', size: '1.8 KB', lastModified: '2026-02-11' }
          ],
          'Redes': [
            { name: 'ModeloOSI.txt', type: 'txt', size: '2.1 KB', lastModified: '2026-02-13' },
            { name: 'Protocolos.txt', type: 'txt', size: '1.9 KB', lastModified: '2026-02-14' }
          ]
        },
        'Entornos_de_Desarrollo': {
          'Git': [
            { name: 'ComandosBasicos.md', type: 'md', size: '1.2 KB', lastModified: '2026-02-18' },
            { name: 'FlujoDeTrabajo.md', type: 'md', size: '1.7 KB', lastModified: '2026-02-19' }
          ],
          'Docker': [
            { name: 'Dockerfile.ejemplo', type: 'dockerfile', size: '0.6 KB', lastModified: '2026-02-22' },
            { name: 'docker-compose.yml', type: 'yml', size: '0.8 KB', lastModified: '2026-02-23' }
          ]
        }
      },
      'DAW': {
        'Programacion': {
          'JavaScript_Basico': [
            { name: 'Fundamentos.js', type: 'js', size: '0.7 KB', lastModified: '2026-02-25' },
            { name: 'DOM.js', type: 'js', size: '1.1 KB', lastModified: '2026-02-26' }
          ]
        }
      }
    };
    
    // Retornar los archivos simulados para la ruta especificada
    return simulatedStructure[course]?.[subject]?.[topic] || [];
  }, []);
  
  // Funci√≥n para obtener contenido simulado de archivos
  const getSimulatedFileContent = useCallback((fileName) => {
    const fileContents = {
      'HolaMundo.java': `// Clase principal para imprimir un mensaje
public class HolaMundo {
    public static void main(String[] args) {
        // Imprimir mensaje en consola
        System.out.println("¬°Hola, mundo desde DAM!");
        
        // Ejemplo de variable
        String saludo = "Bienvenido al ciclo de DAM";
        int anio = 2026;
        
        System.out.println(saludo + " - A√±o: " + anio);
        
        // Operaci√≥n matem√°tica simple
        int resultado = 15 + 27;
        System.out.println("15 + 27 = " + resultado);
    }
}`,
      'Variables.java': `// Ejemplo de declaraci√≥n de variables en Java
public class Variables {
    public static void main(String[] args) {
        // Variables primitivas
        int edad = 25;
        double altura = 1.75;
        char inicial = 'J';
        boolean esEstudiante = true;
        String nombre = "Juan P√©rez";
        
        // Constantes
        final double PI = 3.14159;
        final int DIAS_SEMANA = 7;
        
        // Mostrar valores
        System.out.println("Nombre: " + nombre);
        System.out.println("Edad: " + edad + " a√±os");
        System.out.println("Altura: " + altura + " metros");
        System.out.println("Inicial: " + inicial);
        System.out.println("¬øEs estudiante? " + (esEstudiante ? "S√≠" : "No"));
        System.out.println("Valor de PI: " + PI);
        System.out.println("D√≠as en una semana: " + DIAS_SEMANA);
        
        // Operaciones con variables
        int a = 10, b = 5;
        System.out.println("\\nOperaciones:");
        System.out.println("Suma: " + (a + b));
        System.out.println("Resta: " + (a - b));
        System.out.println("Multiplicaci√≥n: " + (a * b));
        System.out.println("Divisi√≥n: " + (a / b));
    }
}`,
      'CrearTablas.sql': `-- Creaci√≥n de tablas para base de datos de ejemplo
CREATE TABLE IF NOT EXISTS estudiantes (
    id_estudiante INT PRIMARY KEY AUTO_INCREMENT,
    nombre VARCHAR(50) NOT NULL,
    apellido VARCHAR(50) NOT NULL,
    fecha_nacimiento DATE,
    email VARCHAR(100) UNIQUE,
    telefono VARCHAR(20),
    fecha_registro TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS cursos (
    id_curso INT PRIMARY KEY AUTO_INCREMENT,
    nombre_curso VARCHAR(100) NOT NULL,
    descripcion TEXT,
    creditos INT DEFAULT 3,
    duracion_semanas INT
);

CREATE TABLE IF NOT EXISTS inscripciones (
    id_inscripcion INT PRIMARY KEY AUTO_INCREMENT,
    id_estudiante INT,
    id_curso INT,
    fecha_inscripcion DATE DEFAULT (CURRENT_DATE),
    calificacion DECIMAL(5,2),
    FOREIGN KEY (id_estudiante) REFERENCES estudiantes(id_estudiante),
    FOREIGN KEY (id_curso) REFERENCES cursos(id_curso)
);

-- Insertar datos de ejemplo
INSERT INTO cursos (nombre_curso, descripcion, creditos, duracion_semanas) VALUES
('Programaci√≥n Java', 'Fundamentos de programaci√≥n en Java', 6, 16),
('Bases de Datos', 'Dise√±o y gesti√≥n de bases de datos relacionales', 5, 14),
('Sistemas Operativos', 'Conceptos fundamentales de sistemas operativos', 4, 12);`,
      'ClaseCoche.java': `// Clase que representa un coche
public class Coche {
    // Atributos (campos)
    private String marca;
    private String modelo;
    private int anio;
    private String color;
    private double kilometraje;
    private boolean motorEncendido;
    
    // Constructor
    public Coche(String marca, String modelo, int anio, String color) {
        this.marca = marca;
        this.modelo = modelo;
        this.anio = anio;
        this.color = color;
        this.kilometraje = 0.0;
        this.motorEncendido = false;
    }
    
    // M√©todos getters
    public String getMarca() { return marca; }
    public String getModelo() { return modelo; }
    public int getAnio() { return anio; }
    public String getColor() { return color; }
    public double getKilometraje() { return kilometraje; }
    
    // M√©todos setters
    public void setColor(String color) { this.color = color; }
    public void setKilometraje(double kilometraje) { 
        if (kilometraje >= this.kilometraje) {
            this.kilometraje = kilometraje;
        }
    }
    
    // M√©todos de comportamiento
    public void arrancar() {
        if (!motorEncendido) {
            motorEncendido = true;
            System.out.println("El " + marca + " " + modelo + " ha arrancado.");
        } else {
            System.out.println("El motor ya est√° encendido.");
        }
    }
    
    public void apagar() {
        if (motorEncendido) {
            motorEncendido = false;
            System.out.println("El " + marca + " " + modelo + " se ha apagado.");
        } else {
            System.out.println("El motor ya est√° apagado.");
        }
    }
    
    public void conducir(double km) {
        if (motorEncendido) {
            kilometraje += km;
            System.out.println("Has conducido " + km + " km. Kilometraje total: " + kilometraje + " km");
        } else {
            System.out.println("¬°No puedes conducir con el motor apagado!");
        }
    }
    
    // M√©todo toString para representaci√≥n en cadena
    @Override
    public String toString() {
        return "Coche{" +
                "marca='" + marca + '\\'' +
                ", modelo='" + modelo + '\\'' +
                ", a√±o=" + anio +
                ", color='" + color + '\\'' +
                ", kilometraje=" + kilometraje + " km" +
                ", motorEncendido=" + motorEncendido +
                '}';
    }
    
    // M√©todo main para pruebas
    public static void main(String[] args) {
        // Crear un objeto Coche
        Coche miCoche = new Coche("Toyota", "Corolla", 2023, "Azul");
        
        // Mostrar informaci√≥n inicial
        System.out.println("Informaci√≥n del coche:");
        System.out.println(miCoche);
        
        // Probar m√©todos
        miCoche.arrancar();
        miCoche.conducir(150.5);
        miCoche.conducir(85.3);
        miCoche.apagar();
        
        // Cambiar color
        miCoche.setColor("Rojo");
        System.out.println("\\nDespu√©s de cambiar el color:");
        System.out.println(miCoche);
    }
}`,
      'Fundamentos.js': `// Fundamentos de JavaScript para DAW
console.log("=== Fundamentos de JavaScript ===");

// Variables y tipos de datos
let nombre = "Ana Garc√≠a";
const EDAD = 28;
var esDesarrolladora = true;
let altura = 1.68;
let lenguajes = ["HTML", "CSS", "JavaScript", "PHP"];
let vacio = null;
let indefinido = undefined;

console.log("Nombre:", nombre);
console.log("Edad:", EDAD);
console.log("¬øEs desarrolladora?", esDesarrolladora);
console.log("Altura:", altura, "metros");
console.log("Lenguajes:", lenguajes.join(", "));

// Operaciones matem√°ticas
let a = 15, b = 7;
console.log("\\nOperaciones matem√°ticas:");
console.log(\`\${a} + \${b} = \${a + b}\`);
console.log(\`\${a} - \${b} = \${a - b}\`);
console.log(\`\${a} * \${b} = \${a * b}\`);
console.log(\`\${a} / \${b} = \${(a / b).toFixed(2)}\`);
console.log(\`\${a} % \${b} = \${a % b}\`);

// Estructuras de control
console.log("\\nEstructuras de control:");
let hora = 14;
if (hora < 12) {
    console.log("Buenos d√≠as");
} else if (hora < 18) {
    console.log("Buenas tardes");
} else {
    console.log("Buenas noches");
}

// Bucle for
console.log("\\nBucle for:");
for (let i = 1; i <= 5; i++) {
    console.log(\`Iteraci√≥n \${i}\`);
}

// Funciones
console.log("\\nFunciones:");
function calcularAreaRectangulo(base, altura) {
    return base * altura;
}

const area = calcularAreaRectangulo(10, 5);
console.log("√Årea del rect√°ngulo: " + area + " unidades cuadradas");

// Objetos
console.log("\\nObjetos:");
const estudiante = {
    nombre: "Carlos M√©ndez",
    edad: 22,
    carrera: "DAW",
    mostrarInfo: function() {
        return \`\${this.nombre}, \${this.edad} a√±os, estudia \${this.carrera}\`;
    }
};

console.log(estudiante.mostrarInfo());

// Arrays y m√©todos
console.log("\\nArrays y m√©todos:");
let numeros = [1, 2, 3, 4, 5];
console.log("Array original:", numeros);
console.log("Doble de cada n√∫mero:", numeros.map(n => n * 2));
console.log("N√∫meros pares:", numeros.filter(n => n % 2 === 0));
console.log("Suma total:", numeros.reduce((acc, n) => acc + n, 0));

console.log("\\n=== Fin de los fundamentos ===");`
    };
    
    return fileContents[fileName] || `// Contenido no disponible para: ${fileName}\n// Verifica que el archivo exista en el repositorio`;
  }, []);
  
  // =================================================================================================
  // FUNCIONES DE NAVEGACI√ìN Y GESTI√ìN DE HISTORIAL
  // =================================================================================================
  
  // Funci√≥n para cambiar de curso
  const handleCourseChange = useCallback((course) => {
    setCurrentCourse(course);
    const firstSubject = Object.keys(topicsStructure)[0];
    setCurrentSubject(firstSubject);
    setCurrentTopic(topicsStructure[firstSubject][0]);
    setNavigationHistory([course, firstSubject, topicsStructure[firstSubject][0]]);
    setSelectedFile(null);
    setFileContent('');
    setTopicFiles([]);
    
    // Cargar archivos del primer tema
    loadTopicFiles(course, firstSubject, topicsStructure[firstSubject][0]);
  }, [topicsStructure, loadTopicFiles]);
  
  // Funci√≥n para cambiar de asignatura
  const handleSubjectChange = useCallback((subject) => {
    setCurrentSubject(subject);
    setCurrentTopic(topicsStructure[subject][0]);
    setNavigationHistory([currentCourse, subject, topicsStructure[subject][0]]);
    setSelectedFile(null);
    setFileContent('');
    setTopicFiles([]);
    
    // Cargar archivos del primer tema de la asignatura
    loadTopicFiles(currentCourse, subject, topicsStructure[subject][0]);
  }, [currentCourse, topicsStructure, loadTopicFiles]);
  
  // Funci√≥n para cambiar de tema
  const handleTopicChange = useCallback((topic) => {
    setCurrentTopic(topic);
    setNavigationHistory([currentCourse, currentSubject, topic]);
    setSelectedFile(null);
    setFileContent('');
    setTopicFiles([]);
    
    // Cargar archivos del tema seleccionado
    loadTopicFiles(currentCourse, currentSubject, topic);
  }, [currentCourse, currentSubject, loadTopicFiles]);
  
  // Funci√≥n para manejar la selecci√≥n de un archivo
  const handleFileSelect = useCallback((fileName) => {
    loadFileContent(currentCourse, currentSubject, currentTopic, fileName);
  }, [currentCourse, currentSubject, currentTopic, loadFileContent]);
  
  // Funci√≥n para navegar hacia atr√°s en el historial
  const handleBackNavigation = useCallback(() => {
    if (navigationHistory.length > 1) {
      const newHistory = [...navigationHistory];
      newHistory.pop();
      
      if (newHistory.length === 1) {
        // Volver al curso
        handleCourseChange(newHistory[0]);
      } else if (newHistory.length === 2) {
        // Volver a la asignatura
        handleSubjectChange(newHistory[1]);
      } else if (newHistory.length === 3) {
        // Volver al tema
        handleTopicChange(newHistory[2]);
      }
    }
  }, [navigationHistory, handleCourseChange, handleSubjectChange, handleTopicChange]);
  
  // =================================================================================================
  // FUNCIONES DE INTERFAZ DE USUARIO Y UTILIDADES
  // =================================================================================================
  
  // Funci√≥n para formatear fechas
  const formatDate = useCallback((dateString) => {
    if (!dateString) return 'Sin fecha';
    const date = new Date(dateString);
    return date.toLocaleDateString('es-ES', { 
      year: 'numeric', 
      month: 'short', 
      day: 'numeric',
      hour: '2-digit',
      minute: '2-digit'
    });
  }, []);
  
  // Funci√≥n para obtener el icono seg√∫n la extensi√≥n del archivo
  const getFileIcon = useCallback((fileName) => {
    const extension = fileName.split('.').pop().toLowerCase();
    
    switch(extension) {
      case 'java':
        return '‚òï'; // Caf√© para Java
      case 'sql':
        return 'üóÉÔ∏è'; // Base de datos
      case 'js':
        return 'üìú'; // JavaScript
      case 'py':
        return 'üêç'; // Python
      case 'html':
        return 'üåê'; // HTML
      case 'css':
        return 'üé®'; // CSS
      case 'json':
        return 'üîß'; // JSON
      case 'xml':
        return 'üìê'; // XML
      case 'md':
        return 'üìù'; // Markdown
      case 'txt':
        return 'üìÑ'; // Texto
      case 'sh':
      case 'bash':
        return 'üíª'; // Terminal
      case 'yml':
      case 'yaml':
        return '‚öôÔ∏è'; // Configuraci√≥n
      case 'dockerfile':
        return 'üêã'; // Docker
      default:
        return 'üìé'; // Archivo gen√©rico
    }
  }, []);
  
  // Funci√≥n para obtener el color de acento seg√∫n el tipo de archivo
  const getFileColor = useCallback((fileName) => {
    const extension = fileName.split('.').pop().toLowerCase();
    
    switch(extension) {
      case 'java':
        return 'from-yellow-400 to-orange-500';
      case 'sql':
        return 'from-blue-400 to-cyan-500';
      case 'js':
        return 'from-yellow-300 to-yellow-500';
      case 'py':
        return 'from-green-400 to-blue-500';
      case 'html':
        return 'from-orange-400 to-red-500';
      case 'css':
        return 'from-blue-400 to-cyan-400';
      case 'json':
        return 'from-purple-400 to-pink-500';
      case 'md':
        return 'from-gray-400 to-gray-600';
      case 'dockerfile':
        return 'from-blue-500 to-cyan-600';
      default:
        return 'from-gray-400 to-gray-600';
    }
  }, []);
  
  // Funci√≥n para el resaltado de sintaxis
  const highlightCode = useCallback((code, language) => {
    if (!code) return '';
    
    // Definir patrones de resaltado seg√∫n el lenguaje
    const patterns = {
      java: [
        { pattern: /(public|private|protected|static|final|class|interface|extends|implements|new|return|if|else|switch|case|break|for|while|do|try|catch|throw|throws|import|package|void|boolean|byte|char|short|int|long|float|double|String)/g, className: 'text-purple-400 font-medium' },
        { pattern: /\/\/.*/g, className: 'text-green-400 italic' },
        { pattern: /\/\*[\s\S]*?\*\//g, className: 'text-green-500 italic' },
        { pattern: /(".*?")/g, className: 'text-yellow-300' },
        { pattern: /(\b\d+\b)/g, className: 'text-cyan-300' },
        { pattern: /\b(true|false|null)\b/g, className: 'text-blue-300' }
      ],
      sql: [
        { pattern: /(SELECT|FROM|WHERE|JOIN|ON|GROUP BY|HAVING|ORDER BY|INSERT INTO|VALUES|UPDATE|SET|DELETE|CREATE|TABLE|ALTER|DROP|DATABASE|SCHEMA|VIEW|INDEX|PROCEDURE|FUNCTION|TRIGGER|BEGIN|END|COMMIT|ROLLBACK|GRANT|REVOKE|UNION|DISTINCT|AS|AND|OR|NOT|LIKE|IN|BETWEEN|IS NULL|PRIMARY KEY|FOREIGN KEY|REFERENCES|CONSTRAINT)/gi, className: 'text-purple-400 font-medium' },
        { pattern: /--.*/g, className: 'text-green-400 italic' },
        { pattern: /\/\*[\s\S]*?\*\//g, className: 'text-green-500 italic' },
        { pattern: /(".*?"|'.*?')/g, className: 'text-yellow-300' },
        { pattern: /(\b\d+\b)/g, className: 'text-cyan-300' }
      ],
      javascript: [
        { pattern: /(function|const|let|var|if|else|switch|case|break|for|while|do|try|catch|throw|return|import|export|class|extends|super|this|new|typeof|instanceof|void|delete|in|of|await|async|yield|const|let|var|true|false|null|undefined)/g, className: 'text-purple-400 font-medium' },
        { pattern: /\/\/.*/g, className: 'text-green-400 italic' },
        { pattern: /\/\*[\s\S]*?\*\//g, className: 'text-green-500 italic' },
        { pattern: /(".*?"|'.*?')/g, className: 'text-yellow-300' },
        { pattern: /(\b\d+\b)/g, className: 'text-cyan-300' }
      ],
      dockerfile: [
        { pattern: /(FROM|RUN|COPY|ADD|CMD|ENTRYPOINT|EXPOSE|ENV|ARG|VOLUME|WORKDIR|USER|HEALTHCHECK|ONBUILD)/g, className: 'text-purple-400 font-medium' },
        { pattern: /#.*/g, className: 'text-green-400 italic' },
        { pattern: /(".*?"|'.*?')/g, className: 'text-yellow-300' }
      ],
      yaml: [
        { pattern: /#.*/g, className: 'text-green-400 italic' },
        { pattern: /(\w+):/g, className: 'text-blue-300 font-medium' },
        { pattern: /(".*?"|'.*?')/g, className: 'text-yellow-300' }
      ]
    };
    
    // Seleccionar patrones seg√∫n el lenguaje
    let selectedPatterns = patterns.javascript; // Por defecto
    
    if (language === 'java') selectedPatterns = patterns.java;
    else if (language === 'sql') selectedPatterns = patterns.sql;
    else if (language === 'js') selectedPatterns = patterns.javascript;
    else if (language === 'dockerfile') selectedPatterns = patterns.dockerfile;
    else if (language === 'yml' || language === 'yaml') selectedPatterns = patterns.yaml;
    
    // Aplicar resaltado
    let highlighted = code;
    selectedPatterns.forEach(({ pattern, className }) => {
      highlighted = highlighted.replace(pattern, match => 
        `<span class="${className}">${match}</span>`
      );
    });
    
    return highlighted;
  }, []);
  
  // =================================================================================================
  // EFECTOS SECUNDARIOS - REACCIONES A CAMBIOS DE ESTADO
  // =================================================================================================
  
  // Efecto para actualizar el tema de color del sistema
  useEffect(() => {
    document.documentElement.classList.toggle('dark', darkMode);
  }, [darkMode]);
  
  // Efecto para inicializar la aplicaci√≥n
  useEffect(() => {
    // Cargar archivos del tema inicial
    loadTopicFiles(currentCourse, currentSubject, currentTopic);
  }, [loadTopicFiles, currentCourse, currentSubject, currentTopic]);
  
  // =================================================================================================
  // COMPONENTES DE LA INTERFAZ DE USUARIO
  // =================================================================================================
  
  // Componente para el Sidebar de navegaci√≥n
  const Sidebar = () => (
    <motion.div 
      initial={{ x: -300 }}
      animate={{ x: 0 }}
      transition={{ type: "spring", damping: 25, stiffness: 150 }}
      className={`w-72 h-full bg-gradient-to-b ${darkMode ? 'from-gray-900 to-gray-800' : 'from-gray-50 to-gray-100'} border-r ${darkMode ? 'border-gray-700' : 'border-gray-200'} flex flex-col`}
    >
      {/* Header del Sidebar */}
      <div className={`p-5 border-b ${darkMode ? 'border-gray-700' : 'border-gray-200'}`}>
        <div className="flex items-center space-x-3">
          <div className="w-10 h-10 rounded-full bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-center text-white font-bold text-xl">
            D
          </div>
          <div>
            <h2 className={`text-xl font-bold ${darkMode ? 'text-white' : 'text-gray-800'}`}>DAM/DAW Notes</h2>
            <p className={`text-xs ${darkMode ? 'text-gray-400' : 'text-gray-500'}`}>Sistema de gesti√≥n de apuntes</p>
          </div>
        </div>
      </div>
      
      {/* Selector de curso */}
      <div className={`p-4 border-b ${darkMode ? 'border-gray-700' : 'border-gray-200'}`}>
        <label className={`block text-xs font-medium mb-2 ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>CURSO ACTUAL</label>
        <select 
          value={currentCourse}
          onChange={(e) => handleCourseChange(e.target.value)}
          className={`w-full p-2 rounded-lg bg-gradient-to-r from-blue-500 to-indigo-600 text-white font-medium focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 focus:outline-none`}
        >
          <option value="DAM">DAM (Desarrollo de Aplicaciones Multiplataforma)</option>
          <option value="DAW">DAW (Desarrollo de Aplicaciones Web)</option>
        </select>
      </div>
      
      {/* Lista de asignaturas */}
      <div className="p-4 border-b border-gray-700">
        <div className="flex justify-between items-center mb-3">
          <label className="block text-xs font-medium text-gray-400">ASIGNATURAS</label>
          <span className="text-xs bg-blue-500/20 text-blue-300 px-2 py-1 rounded-full">
            {Object.keys(topicsStructure).length}
          </span>
        </div>
        
        <div className="space-y-1 max-h-60 overflow-y-auto pr-2 custom-scrollbar">
          {Object.keys(topicsStructure).map((subject) => (
            <motion.button
              key={subject}
              whileHover={{ x: 5 }}
              whileTap={{ scale: 0.98 }}
              onClick={() => handleSubjectChange(subject)}
              className={`w-full flex items-center space-x-3 p-3 rounded-lg transition-all ${
                currentSubject === subject 
                  ? 'bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-lg shadow-purple-500/20' 
                  : `${darkMode ? 'hover:bg-gray-700/50' : 'hover:bg-gray-100'} ${darkMode ? 'text-gray-300' : 'text-gray-700'}`
              }`}
            >
              <div className={`w-2 h-2 rounded-full ${currentSubject === subject ? 'bg-white' : 'bg-purple-400'}`}></div>
              <span className="font-medium">{subjectDisplayNames[subject] || subject}</span>
            </motion.button>
          ))}
        </div>
      </div>
      
      {/* Lista de temas */}
      <div className="p-4 flex-1 overflow-y-auto custom-scrollbar">
        <div className="flex justify-between items-center mb-3">
          <label className="block text-xs font-medium text-gray-400">TEMAS</label>
          <span className="text-xs bg-green-500/20 text-green-300 px-2 py-1 rounded-full">
            {topicsStructure[currentSubject]?.length || 0}
          </span>
        </div>
        
        <div className="space-y-1">
          {topicsStructure[currentSubject]?.map((topic) => (
            <motion.div
              key={topic}
              layout
              initial={{ opacity: 0, x: -20 }}
              animate={{ opacity: 1, x: 0 }}
              exit={{ opacity: 0, x: -20 }}
              className="flex items-center justify-between p-2 rounded-lg hover:bg-gray-700/30 transition-colors"
            >
              <motion.button
                whileHover={{ x: 5 }}
                whileTap={{ scale: 0.98 }}
                onClick={() => handleTopicChange(topic)}
                className={`flex-1 flex items-center space-x-3 p-2 rounded-lg text-left transition-all ${
                  currentTopic === topic 
                    ? 'bg-gradient-to-r from-indigo-500 to-purple-600 text-white shadow-lg shadow-indigo-500/20' 
                    : `${darkMode ? 'hover:bg-gray-700/50' : 'hover:bg-gray-100'} ${darkMode ? 'text-gray-300' : 'text-gray-700'}`
                }`}
              >
                <div className={`w-1.5 h-1.5 rounded-full ${currentTopic === topic ? 'bg-white' : 'bg-indigo-400'}`}></div>
                <span className="text-sm font-medium">{topicDisplayNames[topic] || topic.replace(/_/g, ' ')}</span>
              </motion.button>
            </motion.div>
          ))}
        </div>
      </div>
      
      {/* Footer del Sidebar */}
      <div className={`p-4 border-t ${darkMode ? 'border-gray-700' : 'border-gray-200'} text-center`}>
        <div className="flex items-center justify-center space-x-2 text-xs text-gray-400">
          <div className="w-2 h-2 rounded-full bg-green-500"></div>
          <span>Sistema optimizado para GitHub</span>
        </div>
        <div className="mt-1 text-xs text-gray-500">
          v2.1.0 ‚Ä¢ DAM/DAW Notes
        </div>
      </div>
    </motion.div>
  );
  
  // Componente para el √°rea de previsualizaci√≥n de c√≥digo
  const CodePreview = () => {
    // Determinar el lenguaje para el resaltado seg√∫n la extensi√≥n
    const language = selectedFile?.endsWith('.java') ? 'java' : 
                     selectedFile?.endsWith('.sql') ? 'sql' : 
                     selectedFile?.endsWith('.js') ? 'js' :
                     selectedFile?.endsWith('.dockerfile') ? 'dockerfile' :
                     selectedFile?.endsWith('.yml') || selectedFile?.endsWith('.yaml') ? 'yaml' : 'javascript';
    
    return (
      <div className="flex-1 flex flex-col bg-gray-900 rounded-xl overflow-hidden border border-gray-800 shadow-2xl">
        {/* Header del editor */}
        <div className="bg-gray-800/80 border-b border-gray-700 p-3 flex items-center justify-between">
          <div className="flex items-center space-x-3">
            <div className="flex space-x-1.5">
              <div className="w-3 h-3 rounded-full bg-red-500"></div>
              <div className="w-3 h-3 rounded-full bg-yellow-500"></div>
              <div className="w-3 h-3 rounded-full bg-green-500"></div>
            </div>
            <div className="flex items-center space-x-2">
              <span className="text-xs font-mono text-gray-400">DAM/DAW-IDE</span>
              <span className="text-xs text-indigo-400 font-medium">‚Ä¢</span>
              <span className="text-xs text-gray-300 truncate max-w-xs">
                {selectedFile ? `${currentCourse}/${currentSubject}/${currentTopic}/${selectedFile}` : 'Sin archivo seleccionado'}
              </span>
            </div>
          </div>
        </div>
        
        {/* √Årea de contenido */}
        <div 
          ref={codeAreaRef}
          className="flex-1 overflow-auto p-4 font-mono text-sm custom-scrollbar bg-gray-900"
        >
          {selectedFile ? (
            <div 
              dangerouslySetInnerHTML={{ 
                __html: highlightCode(fileContent, language) 
              }} 
              className="text-gray-200 whitespace-pre-wrap"
            />
          ) : (
            <div className="text-center text-gray-500 p-12">
              <div className="text-5xl mb-4">üë®‚Äçüíª</div>
              <h3 className="text-xl font-medium mb-2">Selecciona un archivo para ver el c√≥digo</h3>
              <p className="text-gray-400">Navega por los temas en el panel izquierdo y selecciona un archivo para previsualizar su contenido</p>
              <p className="text-gray-500 mt-2 text-sm">Los archivos se cargan directamente desde el repositorio de GitHub</p>
            </div>
          )}
        </div>
        
        {/* Barra de estado */}
        <div className="bg-gray-800/80 border-t border-gray-700 p-2 text-xs text-gray-400">
          <div className="flex justify-between">
            <div>
              <span className="mx-2">Ln {fileContent.split('\n').length}, Col 1</span>
              <span className="mx-2">UTF-8</span>
              <span className="mx-2">{language.toUpperCase()}</span>
            </div>
            <div>
              <span className="mx-2">{selectedFile?.split('.').pop().toUpperCase()} ‚Ä¢ {Math.round(fileContent.length / 1024)} KB</span>
            </div>
          </div>
        </div>
      </div>
    );
  };
  
  // Componente para la lista de archivos
  const FileList = () => {
    return (
      <div className="bg-gray-800/50 rounded-xl border border-gray-700 p-5">
        <div className="flex justify-between items-center mb-4">
          <h3 className="text-lg font-bold text-white flex items-center">
            <span className="mr-2">üìÅ</span>
            Archivos de {topicDisplayNames[currentTopic] || currentTopic.replace(/_/g, ' ')}
          </h3>
          <span className="text-sm bg-blue-500/20 text-blue-300 px-3 py-1 rounded-full">
            {topicFiles.length} archivo{topicFiles.length !== 1 ? 's' : ''}
          </span>
        </div>
        
        {/* Indicador de carga */}
        {isLoading && (
          <div className="text-center py-4">
            <div className="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-500 mb-2"></div>
            <p className="text-gray-400">Cargando archivos desde el repositorio...</p>
          </div>
        )}
        
        {/* Lista de archivos */}
        {!isLoading && topicFiles.length > 0 ? (
          <div className="space-y-2 max-h-80 overflow-y-auto pr-2 custom-scrollbar">
            {topicFiles.map((file, index) => (
              <motion.div
                key={file.name}
                initial={{ opacity: 0, y: 10 }}
                animate={{ opacity: 1, y: 0 }}
                transition={{ delay: index * 0.05 }}
                whileHover={{ x: 5 }}
                className={`flex items-center justify-between p-3 rounded-lg cursor-pointer transition-all ${
                  selectedFile === file.name
                    ? 'bg-gradient-to-r from-indigo-500 to-purple-600 border border-indigo-400 shadow-lg shadow-indigo-500/20'
                    : `${darkMode ? 'hover:bg-gray-700/50' : 'hover:bg-gray-100'} ${darkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'}`
                }`}
                onClick={() => handleFileSelect(file.name)}
              >
                <div className="flex items-center space-x-3 flex-1">
                  <div className={`text-2xl ${getFileColor(file.name)}`}>
                    {getFileIcon(file.name)}
                  </div>
                  <div className="flex-1 min-w-0">
                    <div className={`font-medium truncate ${selectedFile === file.name ? 'text-white' : darkMode ? 'text-gray-200' : 'text-gray-800'}`}>
                      {file.name}
                    </div>
                    <div className={`text-xs ${selectedFile === file.name ? 'text-indigo-100' : 'text-gray-400'}`}>
                      {file.size} ‚Ä¢ √öltima modificaci√≥n: {formatDate(file.lastModified)}
                    </div>
                  </div>
                </div>
                <div className={`text-xs font-mono px-2 py-1 rounded ${
                  file.name.endsWith('.java') ? 'bg-yellow-500/20 text-yellow-300' :
                  file.name.endsWith('.sql') ? 'bg-blue-500/20 text-blue-300' :
                  file.name.endsWith('.js') ? 'bg-yellow-400/20 text-yellow-300' :
                  file.name.endsWith('.py') ? 'bg-green-500/20 text-green-300' :
                  file.name.endsWith('.dockerfile') ? 'bg-blue-500/20 text-blue-300' :
                  file.name.endsWith('.yml') || file.name.endsWith('.yaml') ? 'bg-cyan-500/20 text-cyan-300' :
                  'bg-gray-500/20 text-gray-300'
                }`}>
                  {file.name.split('.').pop().toUpperCase()}
                </div>
              </motion.div>
            ))}
          </div>
        ) : (
          !isLoading && (
            <div className="text-center py-8 text-gray-500">
              <div className="text-3xl mb-3">üì≠</div>
              <p className="font-medium">No hay archivos en este tema</p>
              <p className="text-sm mt-1">A√±ade archivos .java, .sql, etc. en la carpeta correspondiente del repositorio</p>
              <p className="text-xs mt-2 bg-gray-700/50 text-gray-400 p-2 rounded">
                Ruta esperada: {BASE_NOTES_PATH}/{currentCourse}/{currentSubject}/{currentTopic}/
              </p>
            </div>
          )
        )}
        
        {/* Mensaje de error */}
        {loadError && (
          <div className="mt-4 p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-300 text-sm">
            <div className="flex items-start">
              <span className="text-xl mr-2">‚ö†Ô∏è</span>
              <div>
                <p className="font-medium">Error al cargar archivos</p>
                <p>{loadError}</p>
                <p className="mt-1 text-xs opacity-80">
                  Verifica que la estructura de carpetas exista en el repositorio y que los archivos sean accesibles.
                </p>
              </div>
            </div>
          </div>
        )}
      </div>
    );
  };
  
  // Componente para el panel de navegaci√≥n (breadcrumbs)
  const NavigationPanel = () => (
    <div className="bg-gray-800/50 rounded-xl border border-gray-700 p-4 mb-6">
      <div className="flex items-center space-x-2 text-sm text-gray-300">
        <button 
          onClick={handleBackNavigation}
          disabled={navigationHistory.length <= 1}
          className={`p-1 rounded ${navigationHistory.length > 1 ? 'hover:bg-gray-700 text-indigo-400' : 'text-gray-600 cursor-not-allowed'}`}
        >
          ‚óÄ
        </button>
        {navigationHistory.map((item, index) => {
          // Obtener nombre para mostrar
          let displayName = item;
          if (index === 0) displayName = courseDisplayNames[item] || item;
          else if (index === 1) displayName = subjectDisplayNames[item] || item.replace(/_/g, ' ');
          else if (index === 2) displayName = topicDisplayNames[item] || item.replace(/_/g, ' ');
          
          return (
            <React.Fragment key={index}>
              <span className={index === navigationHistory.length - 1 ? 'text-white font-medium' : ''}>
                {displayName}
              </span>
              {index < navigationHistory.length - 1 && (
                <span className="text-gray-500">/</span>
              )}
            </React.Fragment>
          );
        })}
      </div>
    </div>
  );
  
  // =================================================================================================
  // RENDERIZADO PRINCIPAL DE LA APLICACI√ìN
  // =================================================================================================
  
  return (
    <div className={`min-h-screen flex ${darkMode ? 'bg-gray-900 text-gray-100' : 'bg-gray-50 text-gray-800'} font-sans`}>
      {/* Sidebar de navegaci√≥n */}
      <Sidebar />
      
      {/* √Årea de contenido principal */}
      <div className="flex-1 flex flex-col p-6 overflow-auto custom-scrollbar">
        {/* Header con controles superiores */}
        <div className="flex justify-between items-center mb-8">
          <div>
            <h1 className="text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-indigo-400 to-purple-500">
              DAM/DAW Notes Studio
            </h1>
            <p className={`mt-1 ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
              Visualizador de apuntes y c√≥digo fuente desde GitHub
            </p>
          </div>
          
          <div className="flex items-center space-x-4">
            {/* Selector de tema de color */}
            <div className="relative group">
              <div className="flex items-center space-x-2 p-2 bg-gray-800/50 rounded-lg border border-gray-700 cursor-pointer hover:bg-gray-800/70 transition-colors">
                <div className="w-4 h-4 rounded-full bg-gradient-to-r from-purple-500 to-pink-500"></div>
                <span className="text-sm font-medium">Tema</span>
                <span>‚ñº</span>
              </div>
              
              {/* Panel de selecci√≥n de color */}
              <div className="absolute right-0 mt-2 w-48 bg-gray-800 border border-gray-700 rounded-lg p-3 shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50">
                <div className="grid grid-cols-3 gap-2">
                  {['#6366f1', '#8b5cf6', '#ec4899', '#ef4444', '#f59e0b', '#10b981'].map((color) => (
                    <div
                      key={color}
                      className="w-8 h-8 rounded-full cursor-pointer border-2 border-gray-600 hover:scale-110 transition-transform"
                      style={{ backgroundColor: color }}
                      onClick={() => setAccentColor(color)}
                      title={`Cambiar a tema ${color}`}
                    />
                  ))}
                </div>
                <p className="text-xs text-gray-400 mt-2 text-center">
                  (Los cambios de color son solo visuales)
                </p>
              </div>
            </div>
            
            {/* Toggle de modo oscuro */}
            <button
              onClick={() => setDarkMode(!darkMode)}
              className={`p-2 rounded-lg transition-colors ${
                darkMode 
                  ? 'bg-yellow-400/20 text-yellow-300 hover:bg-yellow-400/30' 
                  : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
              }`}
              title={darkMode ? "Cambiar a modo claro" : "Cambiar a modo oscuro"}
            >
              {darkMode ? '‚òÄÔ∏è' : 'üåô'}
            </button>
          </div>
        </div>
        
        {/* Panel de navegaci√≥n (breadcrumbs) */}
        <NavigationPanel />
        
        {/* Contenido principal: Lista de archivos y editor */}
        <div className="grid grid-cols-1 lg:grid-cols-3 gap-6 flex-1">
          {/* Columna izquierda: Lista de archivos */}
          <div className="lg:col-span-1">
            <FileList />
          </div>
          
          {/* Columna derecha: Editor de c√≥digo */}
          <div className="lg:col-span-2">
            <CodePreview />
          </div>
        </div>
        
        {/* Panel de informaci√≥n */}
        <div className={`mt-8 p-5 bg-gray-800/30 rounded-xl border border-gray-700`}>
          <div className="flex flex-col md:flex-row md:items-center md:justify-between">
            <div className="mb-4 md:mb-0">
              <h3 className="text-lg font-bold text-white mb-2 flex items-center">
                <span className="mr-2">‚ÑπÔ∏è</span>
                Informaci√≥n del sistema
              </h3>
              <ul className="text-gray-300 text-sm space-y-1">
                <li>‚Ä¢ Los archivos se cargan directamente desde el repositorio de GitHub</li>
                <li>‚Ä¢ La estructura de carpetas debe seguir el patr√≥n: <code className="bg-gray-700 px-1 rounded">{BASE_NOTES_PATH}/[curso]/[asignatura]/[tema]/</code></li>
                <li>‚Ä¢ Esta es una vista de solo lectura. El c√≥digo no se ejecuta, solo se visualiza</li>
                <li>‚Ä¢ El resaltado de sintaxis funciona para Java, SQL, JavaScript, Dockerfile y YAML</li>
              </ul>
            </div>
            <div className="text-center md:text-right">
              <div className="text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-cyan-400 to-blue-500">
                v2.1.0
              </div>
              <p className="text-gray-400 mt-1">Optimizado para GitHub Pages</p>
              <button 
                onClick={() => window.open('https://github.com/tu-usuario/tu-repositorio', '_blank')}
                className="mt-2 inline-flex items-center space-x-2 bg-gray-700 hover:bg-gray-600 text-white text-sm px-4 py-2 rounded-lg transition-colors"
              >
                <span>‚Üí</span>
                <span>Ver repositorio</span>
              </button>
            </div>
          </div>
        </div>
        
        {/* Footer */}
        <div className={`mt-8 pt-6 border-t ${darkMode ? 'border-gray-800' : 'border-gray-200'} text-center text-sm ${darkMode ? 'text-gray-500' : 'text-gray-600'}`}>
          <p>DAM/DAW Notes Studio ‚Ä¢ Visualizador de apuntes acad√©micos ‚Ä¢ v2.1.0</p>
          <p className="mt-1">Sistema de visualizaci√≥n de c√≥digo fuente optimizado para GitHub Pages</p>
        </div>
      </div>
      
      {/* Estilos personalizados para scrollbars y animaciones */}
      <style jsx global>{`
        .custom-scrollbar::-webkit-scrollbar {
          width: 8px;
          height: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
          background: ${darkMode ? 'rgba(31, 41, 55, 0.5)' : 'rgba(243, 244, 246, 0.8)'};
          border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
          background: ${darkMode ? 'rgba(79, 70, 229, 0.5)' : 'rgba(124, 58, 237, 0.3)'};
          border-radius: 10px;
          border: 2px solid transparent;
          background-clip: content-box;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
          background: ${darkMode ? 'rgba(99, 102, 241, 0.7)' : 'rgba(124, 58, 237, 0.5)'};
        }
        
        @keyframes pulse-slow {
          0% { opacity: 0.5; }
          50% { opacity: 1; }
          100% { opacity: 0.5; }
        }
        .animate-pulse-slow {
          animation: pulse-slow 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
      `}</style>
    </div>
  );
};

export default App;
